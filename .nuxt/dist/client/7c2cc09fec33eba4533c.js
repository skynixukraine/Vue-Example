(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{323:function(e,t,r){"use strict";r.r(t);r(19),r(44);var o={data:function(){return{errors:{}}},methods:{validateEmail:function(e){var t=e.target.name,r=e.target.value;return r?this.checkEmailName(r)?(this.errors.hasOwnProperty(t)&&delete this.errors[t],!0):(this.errors[t]=this.$t("errors.form.unvalid-email-name"),!1):(this.errors[t]=this.$t("errors.form.required-field"),!1)},validatePassword:function(e){var t=e.target.name;return e.target.value?(this.errors.hasOwnProperty(t)&&delete this.errors[t],!0):(this.errors[t]=this.$t("errors.form.required-field"),!1)},validateConfirmPassword:function(e,t){var r=e.target.name,o=e.target.value,n=t.name,c=t.value;return o?this.checkStringEqual(o,c)?(this.errors.hasOwnProperty(r)&&delete this.errors[r],this.errors.hasOwnProperty(n)&&delete this.errors[n],!0):(this.errors[r]=this.$t("errors.form.passwords-not-equal"),!1):(this.errors[r]=this.$t("errors.form.required-field"),!1)},validatePhone:function(e){var t=e.name;return e.isValid?(this.errors.hasOwnProperty(t)&&delete this.errors[t],!0):(this.errors[t]=this.$t("errors.form.invalid-number"),!1)},validateAccept:function(e,t){var r=e.target.name;return t?(this.errors.hasOwnProperty(r)&&delete this.errors[r],!0):(this.errors[r]=this.$t("errors.form.required-field"),!1)},validateFilePDF:function(e){var t=e.target.name,r=e.target.files[0].type,o=e.target.files[0].size/1024/1024;return this.checkFileTypePDF(r)?this.checkFileSize(o)?(this.errors.hasOwnProperty(t)&&delete this.errors[t],!0):(this.errors[t]="File size is too large.",!1):(this.errors[t]="Invalid type. Must be PDF.",!1)},validateFileImage:function(e){var t=e.target.name,r=e.target.files[0].type,o=e.target.files[0].size/1024/1024;return this.checkFileTypeImage(r)?this.checkFileSize(o)?(this.errors.hasOwnProperty(t)&&delete this.errors[t],!0):(this.errors[t]="File size is too large.",!1):(this.errors[t]="Invalid type. Must be Image.",!1)},checkEmailName:function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},checkStringEqual:function(e,t){return e===t},checkFileTypeImage:function(e){return["image/png","image/jpeg"].forEach((function(element){if(element===e)return!0})),!1},checkFileTypePDF:function(e){return["application/pdf"].forEach((function(element){if(element===e)return!0})),!1},checkFileSize:function(e){return e<50}}},n={mixins:[o],data:function(){return{models:{email:"",password:""}}},methods:{onSubmit:function(){var e=this;if(!this.validateForm(this.models))return this.$root.$emit("showNotify",{type:"error",text:"Форма не прошла предварительную валидацию."}),!1;var t=this.prepareDataForSending(this.models);this.$store.dispatch("user/LOGIN_USER",t).then((function(t){e.$store.dispatch("user/LOAD_USER",{id:t.data.doctor_id,token:t.data.access_token})}))},validateForm:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.email){t.next=4;break}return this.errors.email=this.$t("errors.form.required-field"),this.$forceUpdate(),t.abrupt("return",!1);case 4:if(e.password){t.next=8;break}return this.errors.password=this.$t("errors.form.required-field"),this.$forceUpdate(),t.abrupt("return",!1);case 8:if(this.recaptchaToken){t.next=11;break}return this.$root.$emit("showNotify",{type:"error",text:"Рекаптча ТОКЕН не обнаружен. Невозможно отправить форму."}),t.abrupt("return",!1);case 11:return t.abrupt("return",!0);case 12:case"end":return t.stop()}}),null,this)},prepareDataForSending:function(e){var t=new FormData;return t.append("email",e.email),t.append("password",e.password),t.append("recaptcha",this.recaptchaToken),t},onEmailChange:function(e){this.validateEmail(e),this.$forceUpdate()},onPasswordChange:function(e){this.validatePassword(e),this.$forceUpdate()}}},c=r(2),d=Object(c.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("form",{staticClass:"form",attrs:{action:"",method:"POST"},on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[r("div",{staticClass:"form__item"},[r("div",{staticClass:"form__title"},[e._v(e._s(e.$t("forms.enter-email")))]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.models.email,expression:"models.email"}],ref:"email",staticClass:"input",attrs:{type:"email",name:"email"},domProps:{value:e.models.email},on:{keyup:e.onEmailChange,input:function(t){t.target.composing||e.$set(e.models,"email",t.target.value)}}}),e._v(" "),e.errors.email?r("div",{staticClass:"form__message"},[e._v(e._s(e.errors.email))]):e._e()]),e._v(" "),r("div",{staticClass:"form__item"},[r("div",{staticClass:"form__title"},[e._v(e._s(e.$t("forms.enter-password")))]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.models.password,expression:"models.password"}],ref:"password",staticClass:"input",attrs:{type:"password",name:"password"},domProps:{value:e.models.password},on:{keyup:e.onPasswordChange,input:function(t){t.target.composing||e.$set(e.models,"password",t.target.value)}}}),e._v(" "),e.errors.password?r("div",{staticClass:"form__message"},[e._v(e._s(e.errors.password))]):e._e()]),e._v(" "),r("div",{staticClass:"form__item"},[r("button",{staticClass:"link link--button link--button-blue",attrs:{type:"submit"}},[e._v(e._s(e.$t("links.signin")))])])])}),[],!1,null,null,null).exports,l=(r(23),r(16),r(43),{mixins:[o,r(120).a],created:function(){var e=this;this.$recaptchaLoaded().then((function(){e.loadAndSetRecaptchaToken(e.$recaptchaActions.registerDoctor)}))},data:function(){return{models:{email:"",password:"",password_confirmation:"",phone_number:"",degree:"",certification:"",accepted:!1},isFormSending:!1}},methods:{onSubmit:function(){var e,t=this;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.isFormSending=!0,this.validateForm(this.models)){r.next=4;break}return this.isFormSending=!1,r.abrupt("return",!1);case 4:e=this.prepareDataForSending(this.models),this.$store.dispatch("user/REGISTER_USER",e).then((function(e){t.$store.dispatch("user/LOAD_USER",{id:e.data.doctor_id,token:e.data.access_token}).then((function(e){t.$modal.show("register-success"),t.loadAndSetRecaptchaToken(t.$recaptchaActions.registerDoctor),t.isFormSending=!1}))})).catch((function(e){t.handleErrorResponse(e.errors),t.loadAndSetRecaptchaToken(t.$recaptchaActions.registerDoctor),t.isFormSending=!1}));case 6:case"end":return r.stop()}}),null,this)},validateForm:function(e){return e.email?e.password?e.password_confirmation?e.phone_number?e.accepted?!!this.recaptchaToken||(this.$root.$emit("showNotify",{type:"error",text:"Нет токена рекапчи"}),!1):(this.errors.accepted=this.$t("errors.form.required-field"),this.$forceUpdate(),this.$root.$emit("showNotify",{type:"error",text:"Вы должны согласится с правилами сайта"}),!1):(this.errors.phone_number=this.$t("errors.form.required-field"),this.$forceUpdate(),this.$root.$emit("showNotify",{type:"error",text:"Телефон не заполнен"}),!1):(this.errors.password_confirmation=this.$t("errors.form.required-field"),this.$forceUpdate(),this.$root.$emit("showNotify",{type:"error",text:"Конфирм Пароль не заполнен"}),!1):(this.errors.password=this.$t("errors.form.required-field"),this.$forceUpdate(),this.$root.$emit("showNotify",{type:"error",text:"Пароль не заполнен"}),!1):(this.errors.email=this.$t("errors.form.required-field"),this.$forceUpdate(),this.$root.$emit("showNotify",{type:"error",text:"Имейл не заполнен"}),!1)},handleErrorResponse:function(e){if(0===Object.keys(e).length)return!0;for(var t in e)this.errors[t]=e[t][0];return this.$forceUpdate(),!0},prepareDataForSending:function(e){var t=new FormData;return t.append("email",e.email),t.append("phone_number",e.phone_number),t.append("password",e.password),t.append("password_confirmation",e.password_confirmation),t.append("accepted",e.accepted),e.degree&&t.append("medical_degree",e.degree),e.certification&&t.append("medical_degree",e.certification),t.append("recaptcha",this.recaptchaToken),t},addFileDegree:function(){this.$refs.degree.click()},addFileCertification:function(){this.$refs.certification.click()},onEmailChange:function(e){this.validateEmail(e),this.$forceUpdate()},onPasswordChange:function(e){this.validateConfirmPassword(e,this.$refs.password_confirmation),this.$forceUpdate()},onConfirmPasswordChange:function(e){this.validateConfirmPassword(e,this.$refs.password),this.$forceUpdate()},onPhoneChange:function(e,t){this.validatePhone(t)},onDegreeUpload:function(e){this.validateFilePDF(e)&&(this.models.degree=e.target.files[0])},onCertificationUpload:function(e){this.validateFilePDF(e)&&(this.models.certification=e.target.files[0])},onAcceptChange:function(e){this.validateAccept(e,this.models.accepted)}}}),m=Object(c.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("form",{staticClass:"form",attrs:{action:"",method:"POST"},on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[r("div",{staticClass:"form__item"},[r("div",{staticClass:"form__title"},[e._v(e._s(e.$t("forms.enter-email")))]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.models.email,expression:"models.email"}],ref:"email",staticClass:"input",attrs:{type:"email",name:"email"},domProps:{value:e.models.email},on:{keyup:e.onEmailChange,input:function(t){t.target.composing||e.$set(e.models,"email",t.target.value)}}}),e._v(" "),e.errors.email?r("div",{staticClass:"form__message"},[e._v(e._s(e.errors.email))]):e._e()]),e._v(" "),r("div",{staticClass:"form__item"},[r("div",{staticClass:"form__title"},[e._v(e._s(e.$t("forms.create-password")))]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.models.password,expression:"models.password"}],ref:"password",staticClass:"input",attrs:{type:"password",name:"password"},domProps:{value:e.models.password},on:{keyup:e.onPasswordChange,input:function(t){t.target.composing||e.$set(e.models,"password",t.target.value)}}}),e._v(" "),e.errors.password?r("div",{staticClass:"form__message"},[e._v(e._s(e.errors.password))]):e._e()]),e._v(" "),r("div",{staticClass:"form__item"},[r("div",{staticClass:"form__title"},[e._v(e._s(e.$t("forms.confirm-password")))]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.models.password_confirmation,expression:"models.password_confirmation"}],ref:"password_confirmation",staticClass:"input",attrs:{type:"password",name:"password_confirmation"},domProps:{value:e.models.password_confirmation},on:{keyup:e.onConfirmPasswordChange,input:function(t){t.target.composing||e.$set(e.models,"password_confirmation",t.target.value)}}}),e._v(" "),e.errors.password_confirmation?r("div",{staticClass:"form__message"},[e._v(e._s(e.errors.password_confirmation))]):e._e()]),e._v(" "),r("div",{staticClass:"form__item"},[r("div",{staticClass:"form__title"},[e._v(e._s(e.$t("forms.phone-number")))]),e._v(" "),r("vue-tel-input",{attrs:{name:"phone_number"},on:{input:e.onPhoneChange},model:{value:e.models.phone_number,callback:function(t){e.$set(e.models,"phone_number",t)},expression:"models.phone_number"}}),e._v(" "),e.errors.phone_number?r("div",{staticClass:"form__message"},[e._v(e._s(e.errors.phone_number))]):e._e()],1),e._v(" "),r("div",{staticClass:"form__item"},[r("div",{staticClass:"form__title"},[e._v(e._s(e.$t("forms.upload-degree")))]),e._v(" "),r("input",{ref:"degree",staticClass:"input input--hidden",attrs:{type:"file",name:"degree"},on:{change:e.onDegreeUpload}}),e._v(" "),r("button",{staticClass:"link link--button link--button-white",attrs:{type:"button"},on:{click:e.addFileDegree}},[e._v("Add Degree")]),e._v(" "),e.errors.degree?r("div",{staticClass:"form__message"},[e._v(e._s(e.errors.degree))]):e._e()]),e._v(" "),r("div",{staticClass:"form__item"},[r("div",{staticClass:"form__title"},[e._v(e._s(e.$t("forms.upload-certification")))]),e._v(" "),r("input",{ref:"certification",staticClass:"input input--hidden",attrs:{type:"file",name:"certification"},on:{change:e.onCertificationUpload}}),e._v(" "),r("button",{staticClass:"link link--button link--button-white",attrs:{type:"button"},on:{click:e.addFileCertification}},[e._v("Add Certification")]),e._v(" "),e.errors.certification?r("div",{staticClass:"form__message"},[e._v(e._s(e.errors.certification))]):e._e()]),e._v(" "),r("div",{staticClass:"form__item"},[r("div",{staticClass:"form__title"},[e._v(e._s(e.$t("forms.i-accept")))]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.models.accepted,expression:"models.accepted"}],ref:"accepted",attrs:{type:"checkbox",name:"accepted"},domProps:{checked:Array.isArray(e.models.accepted)?e._i(e.models.accepted,null)>-1:e.models.accepted},on:{change:[function(t){var r=e.models.accepted,o=t.target,n=!!o.checked;if(Array.isArray(r)){var c=e._i(r,null);o.checked?c<0&&e.$set(e.models,"accepted",r.concat([null])):c>-1&&e.$set(e.models,"accepted",r.slice(0,c).concat(r.slice(c+1)))}else e.$set(e.models,"accepted",n)},e.onAcceptChange]}}),e._v(" "),e.errors.accepted?r("div",{staticClass:"form__message"},[e._v(e._s(e.errors.accepted))]):e._e()]),e._v(" "),r("div",{staticClass:"form__item"},[r("button",{staticClass:"link link--button link--button-blue",attrs:{type:"submit",disabled:e.isFormSending}},[e._v(e._s(e.isFormSending?"loading...":e.$t("links.signup")))])])])}),[],!1,null,null,null).exports,f={beforeCreate:function(){var e=this;setTimeout((function(){e.$store.dispatch("user/AUTOLOGIN_USER",{token:e.$store.getters["user/TOKEN"],user:e.$store.getters["user/USER"]})}),0)},data:function(){return{currentTab:"signin"}},methods:{setCurrentTab:function(e){this.currentTab=e}},components:{SigninForm:d,SignupForm:m}},h=Object(c.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page"},[r("div",{staticClass:"section"},[r("div",{staticClass:"container"},[r("button",{staticClass:"link link--button link--button-white",on:{click:function(t){return e.setCurrentTab("signin")}}},[e._v("Sign In")]),e._v(" "),r("button",{staticClass:"link link--button link--button-white",on:{click:function(t){return e.setCurrentTab("signup")}}},[e._v("Sign Up")]),e._v(" "),"signin"===e.currentTab?[r("SigninForm")]:e._e(),e._v(" "),"signup"===e.currentTab?[r("SignupForm")]:e._e(),e._v(" "),r("button",[e._v("Forgot Password?")])],2)])])}),[],!1,null,null,null);t.default=h.exports}}]);